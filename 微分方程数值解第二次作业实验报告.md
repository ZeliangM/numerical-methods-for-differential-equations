### <center> 微分方程数值解第二次作业实验报告</center>

<center>苗泽亮   2200502177</center>

#### 数值实验一：

![image-20211015181135233](C:\Users\miaoz\AppData\Roaming\Typora\typora-user-images\image-20211015181135233.png)

**实验结果：**


<center>迭代格式中含有三次方项数值实验表</center>

| h       | $t_i$ | $y_i$              | $y(t_i)$           | $y_i-y(t_i)$           |
| ------- | ----- | ------------------ | ------------------ | ---------------------- |
|         | 0.1   | 0.6574145833333334 | 0.6574145409621761 | 4.237115724947671e-08  |
| h=0.1   | 0.5   | 1.4256396807015814 | 1.425639364649936  | 3.1605164552139797e-07 |
|         | 1     | 2.6408601279324184 | 2.6408590857704777 | 1.0421619416334238e-06 |
|         | 2     | 5.305477616312231  | 5.305471950534675  | 5.665777555563523e-06  |
|         |       |                    |                    |                        |
|         | 0.1   | 0.6574145409667427 | 0.6574145409621761 | 4.566569344888194e-12  |
| h=0.01  | 0.5   | 1.4256393646839987 | 1.425639364649936  | 3.406230852931458e-11  |
|         | 1     | 2.640859085882799  | 2.6408590857704777 | 1.1231948704448769e-10 |
|         | 2     | 5.305471951145318  | 5.305471950534675  | 6.106404271122301e-10  |
|         |       |                    |                    |                        |
|         | 0.1   | 0.6574145409621768 | 0.6574145409621761 | 4.440892098500626e-16  |
| h=0.001 | 0.5   | 1.4256393646499381 | 1.425639364649936  | 1.3322676295501878e-15 |
|         | 1     | 2.6408590857704866 | 2.6408590857704777 | 7.105427357601002e-15  |
|         | 2     | 5.305471950534975  | 5.305471950534675  | 5.524469770534779e-13  |

<img src="D:\cnu\course\Differential_Equation\homework\2\error.png" style="zoom: 150%;" />

<center>迭代格式中不含三次方项数值实验表</center>

| h       | $t_i$ | $y_i$              | $y(t_i)$           | $y_i-y(t_i)$            |
| ------- | ----- | ------------------ | ------------------ | ----------------------- |
|         | 0.1   | 0.6574166666666666 | 0.6574145409621761 | 2.1257044905409472e-06  |
| h=0.1   | 0.5   | 1.4256459636452805 | 1.425639364649936  | 6.598995344608838e-06   |
|         | 1     | 2.6408611495818413 | 2.6408590857704777 | 2.063811364472201e-06   |
|         | 2     | 5.3054333138924274 | 5.305471950534675  | -3.8636642248235376e-05 |
|         |       |                    |                    |                         |
|         | 0.1   | 0.6574145428610434 | 0.6574145409621761 | 1.8988672856323774e-09  |
| h=0.01  | 0.5   | 1.425639369624221  | 1.425639364649936  | 4.974284761871672e-09   |
|         | 1     | 2.640859083103341  | 2.6408590857704777 | -2.6671385100485168e-09 |
|         | 2     | 5.305471894674679  | 5.305471950534675  | -5.5859998404628186e-08 |
|         |       |                    |                    |                         |
|         | 0.1   | 0.6574145409640502 | 0.6574145409621761 | 1.8738344209623392e-12  |
| h=0.001 | 0.5   | 1.4256393646547356 | 1.425639364649936  | 4.798828001639777e-12   |
|         | 1     | 2.6408590857673064 | 2.6408590857704777 | -3.1730174043786974e-12 |
|         | 2     | 5.305471950477257  | 5.305471950534675  | -5.716582762715916e-11  |

**实验分析：**

1. 通过比较不同的h下同一t处的数值可以发现上述迭代格式为4阶精度。
2. $\frac{h^3}{24}$这一项的作用是控制迭代的稳定性，提高迭代格式精度。通过上图可以看到步长h=0.05与h=0.1时含有$\frac{h^3}{24}$的迭代格式稳定性更好，尤其是步长h=0.1时，不含$\frac{h^3}{24}$的迭代格式相对波动很大。同时通过不含三次方项数值实验表可以看到，误差精度降为了3阶。

#### 数值实验二：

2. 用中点方法、改进欧拉方法及Heun方法求解

$$
y'=-y +x+1; y(0)=1:0\leq x\leq2
$$

自选步长序列$h_j$，观察三种方法给出的近似值，有什么现象？试解释.

<img src="D:\cnu\course\Differential_Equation\homework\2\errorh=0.1.png"  />

<img src="D:\cnu\course\Differential_Equation\homework\2\h=0.01.png"  />

**实验分析：**

- 通过选取的步长h,可以看到中点方法、改进欧拉方法以及Heun二阶方法，它们的数值解是一致的，显然它们的误差阶数是相同的。这是因为采用单步法思想，试图得到更精确解的过程中，最终得到的是求解关于3个未知数（假设$a_2=b_2$）2个方程，理论上有无穷多解，上述三种方法仅仅是其中几组解，而精度并不能突破2阶。

#### 数值实验三：

![](D:\cnu\course\Differential_Equation\homework\2\3.JPG)

**实验结果：**

<img src="D:\cnu\course\Differential_Equation\homework\2\3_err.png" style="zoom:150%;" />

<center>计算量相当（h=0.025、h=0.05、h=0.1）时三种方法误差（y（估计）-y(真解)）</center>

| $x_n$ | 直接欧拉方法误差      | 改进欧拉方法误差        | 四阶龙格库塔误差        |
| ----- | --------------------- | ----------------------- | ----------------------- |
| 0.1   | 0.0011495274109595277 | -3.9144464040477556e-05 | -8.196404048532724e-08  |
| 0.2   | 0.002078949415719872  | -7.08402838345834e-05   | -1.483282681680187e-07  |
| 0.3   | 0.002819874855066684  | -9.615048904532131e-05  | -2.013194598249335e-07  |
| 0.4   | 0.0033998776108135065 | -0.00011600325620997332 | -2.428818512978381e-07  |
| 0.5   | 0.00384297949353285   | -0.00013120794665572033 | -2.7471074648399707e-07 |

**实验分析：**

- 直接欧拉方法、改进欧拉方法以及四阶龙格库塔方法的运算精度逐渐提高，为了保证运算量大致相同，选取了不同的步长。本实验可以看到：与前面两种方法相比，龙格—库塔方法仅一步就将误差降为$10^{-8}$,它的运算效率还是很高的。

